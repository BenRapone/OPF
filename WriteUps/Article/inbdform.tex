\section{Computing Lower Bounds on the Robustness Margin} \label{sec:inbdform}  

\begin{thm}
Let $\Omega=\{\vx| A\vx< \vb\}$, $\Omega_{u}=\{\vu| u^{\min}_i\leq u_i \leq u^{\max}_i \ \forall i \}$, and $F(\vx)=Q(\vx)+L(\vx)$ as described in \cref{eq:Quad}, \cref{eq:xLimits} and \cref{eq:uLimits}. 
Let
$$z = \min\limits_{\vx\in \partial \Omega, \vu\in \Omega_{u} }\max\limits_{||\boldsymbol{\lambda}||=1}\ \boldsymbol{\lambda}^T\left(F(\vx)-\vu\right).$$
If $r>0$ s.t. $r\leq e_i \ \forall i \ s.t. \ e_i>0$ where $e$ denotes the error bounds associated with $ u^{\min}_i$ and $ u^{\max}_i$, and if $z>0$ then the system is robust feasible and has a robustness margin of at least r.

\begin{proof} 
If \cref{eq:RSForm} is invalidated then $\exists \hat{\vx}\in\partial\Omega$ s.t. $F(\hat{\vx})=\hat{\vu}$ for some $\hat{\vu}\in\Omega_{u}$ and thus $$z = \min\limits_{\vx\in \partial \Omega}\max\limits_{||\boldsymbol{\lambda}||=1}\ \boldsymbol{\lambda}^T\left(F(\vx)-\vu\right)\leq \max\limits_{||\boldsymbol{\lambda}||=1, \vx=\hat{\vx}}\ \boldsymbol{\lambda}^T\left(F(\vx)-\hat{\vu}\right)=0.$$ 
Hence if $z>0$, \cref{eq:RSForm} is validated, and the system is robust feasible. It follows then by definition that the system has a robustness margin of at least r.
\end{proof}
\end{thm}

\begin{thm} \label{thm:RobFeas}
Let $\partial\Omega_i=\{\vx| (A\vx)_i = b_i, A\vx\leq \vb\}$, $\Omega_{u}=\{\vu| u^{\min}_i\leq u_i \leq u^{\max}_i \ \forall i \}$, and $F(\vx)=Q(\vx)+L(\vx)$ as described in \cref{eq:Quad}, \cref{eq:xLimits} and \cref{eq:uLimits}. Define
\begin{align}
\mathrm{z}_i =  \min_{\vx\in\partial\Omega_i, u\in \Omega_u} ||F(\vx)-u||. \label{eq:OPTfeas}
\end{align}
If $\mathrm{z}_i>0$ for each $i = 1, \ldots, m$ (where $m$ is the number of rows of $A$), then the system is robust feasible.

\begin{proof} 
If \cref{eq:RSForm} is invalidated then $\exists \hat{\vx}\in\partial\Omega$, $\Omega=\{\vx| A\vx< \vb\}$, s.t. $F(\hat{\vx})=\hat{\vu}$ for some $\hat{\vu}\in \Omega_u$. 
Since $\hat{\vx}\in\partial\Omega$ this implies that $\exists i$ s.t. $A\hat{\vx}_i=b_i$ and thus $0\leq \mathrm{z}_i \leq ||F(\hat{\vx})-\hat{\vu}||=0$.
Thus if $\mathrm{z}_i>0$ for each $i = 1, \ldots, m$, \cref{eq:RSForm} is validated, and the system is robust feasible as desired.
\end{proof}
\end{thm}

%Note that under these circumstances $\min\limits_{||\boldsymbol{\lambda}||=1}\max\limits_{x\in \bar{\Omega}}\ \boldsymbol{\lambda}^T\left(F(x)-\hat{u}\right)> 0$ is possible, especially if $F(\bar{\Omega})$ is highly non-convex. However, should $\exists u^{\prime}$ s.t. $\min\limits_{||\boldsymbol{\lambda}||=1}\max\limits_{x\in \bar{\Omega}}\ \boldsymbol{\lambda}^T\left(F(x)-u^{\prime}\right)=0$ then by \ref{MainInEqLem} we know that there $\exists \hat{x}\in\partial\Omega$ s.t. $F(\hat{x})=u^{\prime}$. Hence the following formulation of an outer bound approximation on $u_i^{\min}$ and $u_i^{\max}$:


The optimization problems presented in \cref{thm:RobFeas} are nonlinear and nonconvex.
Hence it may be difficult to solve them in general.
However, since $F(\vx)$ is quadratic in $\vx$, they are quadratically constrained quadratic programs (QCQPs), and we can use well known \emph{semidefinite programming relaxations for QCQPs} 
to obtain lower bounds on the optimal values.\cite{VaBo1996} 
Since $Q$ is quadratic, it can also be written as a linear function of $\vx\vx^T$.
More concretely, we can write
$$Q(\vx)_i=\vx^TM_i\vx=\Tr(M_i\vx\vx^T)$$
where each $M_i$ is as defined in \cref{eq:Quad}. 
Since, $A\vx\leq \vb$ this implies that $(\vb-A\vx)(\vb-A\vx)^T\geq 0\Rightarrow \vb\vb^T-A\vx\vb^T-\vb(A\vx)^T+A(\vx\vx^T)A^T\geq 0$. 
If we allow a symmetric positive semidefinite matrix $X$ to take the place of $\vx\vx^T$ we can construct the following relaxation of the model presented in \cref{thm:RobFeas}:
 
\begin{equation}\label{eq:OPTfeasrelax}
  \begin{array}{rl}
    \hat{\mathrm{z}}_{i} = & \min\limits_{\vx}  b_i-(A\vx)_i  \\
    \vspace*{-0.05in} \\
%\begin{align*}
    \text{subject to: } \ & \Tr\left(M_iX\right)+ L_i\vx \geq \vu_i^{min} \ \ \forall i\\
    & \Tr\left(M_iX\right)+ L_i\vx \leq \vu_i^{max} \ \ \forall i\\
    &A\vx\leq \vb \\
    &\vb\vb^T-A\vx\vb^T-\vb(A\vx)^T+AXA^T\geq O \\
    &X \text{ is symmtric, positive semidefinite}
  \end{array}
\end{equation}
%\end{align*}
%
where $L_i$ denotes the $i^{th}$ rows of $L$, and $O$ denotes the $2n \times 2n$ matrix of zeros with the constraints understood to be componentwise inequalities. 
This is a convex optimization problem (a semidefinite program, in fact) and can be solved efficiently. 
Since this is a relaxation of the model in \cref{thm:RobFeas}, if $\hat{\mathrm{z}}_i>0$ for each $i$, the condition in \cref{thm:RobFeas} (i.e. $z_i>0 \ \forall i$) is satisfied. 
We can further relax the model in \cref{eq:OPTfeasrelax} by dropping the condition that $X$ be positive semidefinite, which transforms the model from a semidefinite program to a linear program. 
We now present three formulations for this new, relaxed program that we provide numerical results for in the coming section.\\

\textbf{LP Feasibility Model} 
\begin{equation} \label{eq:OPTfeasrelaxLP1}
\begin{array}{rl}
 &\text{Find a }\vx \\
 \text{subject to: } \ &(A\vx)_i= b_i \\
 &\Tr\left(M_iX\right)+ L_i\vx \geq \vu_i^{\min}  \ \ \forall i\\
 & \Tr\left(M_iX\right)+ L_i\vx \leq \vu_i^{\max}  \ \ \forall i\\
 	&A\vx\leq \vb \\
 	&\vb\vb^T-A\vx\vb^T-\vb(A\vx)^T+AXA^T\geq O \\
 	&X \text{ is symmtric}
\end{array}
\end{equation}


This model has the advantage of being a linear program and hence can be solved efficiently, but as noted by the objective $z_i$, one must iterate over each dimension of $A\vx$ checking feasibility of the model. 
Of course should the model prove feasible then we have found a solution on the boundary and thus invalidating (\cref{eq:RSForm}). 
If the model proves infeasible then we are free to push the robust margin higher and test again. 
An alternative approach would be to deal with all of the dimensions of $A\vx$ simultaneously by introducing some binaries and creating a MIP as follows. \\

\textbf{MIP Model}\
\begin{equation}\label{eq:OPTfeasrelaxLP2}
\begin{array}{rl}
 & \max z  \\
 \text{subject to: } \ &\Tr\left(M_iX\right)+ L_i\vx \geq \vu_i^{\min}  \ \ \forall i\\
 & \Tr\left(M_iX\right)+ L_i\vx \leq \vu_i^{max}  \ \ \forall i\\
 	&A\vx\leq \vb \\
 	&\vb\vb^T-A\vx\vb^T-\vb(A\vx)^T+AXA^T\geq O \\
 	&X \text{ is symmtric} \\
 	& z\leq (A\vx)_i-b_i+R(1-d_i) \ \forall i \ \text{ for some large enough $R$} \\
 	& \sum\limits_i d_i=1 \\
 	& d_i\in\{0,1\}
\end{array}
\end{equation}


The MIP Model and LP Feasibility model are extremely similar and should theoretically give the same results. 
However, as we will show in our numerical studies the LP Feasibility model will out perform the MIP Model in terms of speed at higher dimensions. 
In both models the process ends after a boundary solution is found. 
This solution may not be a boundary solution to the actual system, but may be an artifact of the relaxations used to create the models. 
One way of tackling this issue is by updating the constraints using an iterative process we outline in the following model.\\

\textbf{LP Bound Tightening Model}
\begin{equation}\label{eq:OPTfeasrelaxLP3}
\begin{array}{rl}
\mathrm{z}_{i} &  = \max_x (A\vx)_i  \\
 \text{subject to: } \ &\Tr\left(M_iX\right)+ L_i\vx \geq \vu_i^{\min}  \ \ \forall i\\
 & \Tr\left(M_iX\right)+ L_i\vx \leq \vu_i^{max}  \ \ \forall i\\
 	&A\vx\leq \vb \\
 	&\vb\vb^T-A\vx\vb^T-\vb(A\vx)^T+AXA^T\geq O \\
 	&X \text{ is symmtric}
\end{array}
\end{equation}


As noted, what distinguishes the LP Bound Tightening model is its ability to be used iteratively by updating the constraints of \cref{eq:OPTfeasrelaxLP3}, replacing $\vb$ with $\vz$ (the vector of $z_i$'s found after running the model over all dimensions of $A\vx$). 
Since clearly $\vb\leq \vz$ we have that the polytope $\{A\vx\leq \vz\}\subseteq\{A\vx\leq \vb\}$. 
Thus it follows that any system deemed robust feasible using \cref{eq:OPTfeasrelaxLP1} or \cref{eq:OPTfeasrelaxLP2} would certainly be found robust feasible using \cref{eq:OPTfeasrelaxLP3}, but a system found robust feasible using \cref{eq:OPTfeasrelaxLP3} may not be found robust feasible using \cref{eq:OPTfeasrelaxLP1} or \cref{eq:OPTfeasrelaxLP2}. 
The drawback, as we shall see in the numerical studies, is the choice of modeling parameters which must be manually set to tell the program when to stop running models. 

